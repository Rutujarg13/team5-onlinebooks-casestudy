<div class="container">
    <div>
<h6>Add New Book</h6>
<form class="form-inline" method="post" (submit)="newBook($event)">
    <div class="input-group ">
  <div class="form-group ">
    <input type="text" [(ngModel)]="newTitle" name="title" class="form-control" id="title" placeholder="Title" required>
  </div>
  <div class="form-group">
    <input type="text" name="author" class="form-control" [(ngModel)]="selectedAuthor" (ngModelChange)="getAuthorId()" [ngModelOptions]="{standalone: true}" matInput [matAutocomplete]="auto1" placeholder="Author" required>
        <mat-autocomplete #auto1="matAutocomplete">
          <mat-option *ngFor="let author of authors" [value]="author.first_name+' '+author.last_name">
            {{author.first_name}} {{author.last_name}}
          </mat-option>
        </mat-autocomplete>
  </div>
  <div class="form-group">
    <input type="text" name="publisher" class="form-control" [(ngModel)]="selectedPublisher" (ngModelChange)="getPublisherId()" [ngModelOptions]="{standalone: true}" matInput [matAutocomplete]="auto2" placeholder="Publisher" required>
    <mat-autocomplete #auto2="matAutocomplete">
      <mat-option *ngFor="let publisher of publishers" [value]="publisher.publisher_name">
        {{publisher.publisher_name}}
      </mat-option>
    </mat-autocomplete>
  </div>
  <div class="form-group">
    <input type="text" name="category" class="form-control" [(ngModel)]="selectedCategory" (ngModelChange)="getCategoryId()" [ngModelOptions]="{standalone: true}" matInput [matAutocomplete]="auto3" placeholder="Category" required>
        <mat-autocomplete #auto3="matAutocomplete">
          <mat-option *ngFor="let category of categories" [value]="category.category_name">
            {{category.category_name}}
          </mat-option>
        </mat-autocomplete>
  </div>
  <div class="form-group">
    <input type="number" name="price" [(ngModel)]="price" class="form-control" id="price" placeholder="â‚¹ 0.00"  required>
  </div>
  <div class="form-group">
    <input type="text" name="quantity" [(ngModel)]="quantity" [ngModelOptions]="{standalone: true}" class="form-control" id="qty" placeholder="Quantity" required> 
  </div>
  <div class="form-group">
    <textarea name="description" [(ngModel)]="description" [ngModelOptions]="{standalone: true}" class="form-control" id="description" placeholder="Add Description Here"  required></textarea>
  </div>
  <div class="form-group">
     <input type="file" (change)="uploadFile($event)"  #selectFile>
  <button type="submit" class="btn btn-primary">Add</button>
</div>
</div>
</form>
</div>
<div>
    <h6 class="mt-5">Edit Book Details</h6>
    <input type="text" class="form-control mt-3 mb-3" [value]="filter" id="search" (keyup)="transformFilter($event)" placeholder="Search Titles">
</div>
<div>
    <table class="table table-bordered">
        <thead>
          <tr>
            <th>Title</th>
            <th>Author</th>
            <th>Publisher</th>
            <th>Category</th>
            <th>Price</th>
            <th>Quantity</th>
            <!-- <th>Update</th> -->
            <th>Delete</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let book of bookList">
            <ng-container *ngIf="book.title.toLowerCase().includes(filter)">
            <td>{{book.title}}</td>
            <table>
            <tr *ngFor="let author of booksAuthors">
              <td *ngIf="author.book_id===book.book_id">{{author.first_name}} {{author.last_name}}</td>
            </tr>
          </table>
            <td>{{book.publisher_name}}</td>
            <td>{{book.category_name}}</td>
            <!-- On change update price -->
            <td><input type="number" [(ngModel)]="book.price" [ngModelOptions]="{standalone: true}" (change)="editBook(book)"></td>
            <!-- On change update quantity -->
            <td><input type="number" [(ngModel)]="book.quantity" [ngModelOptions]="{standalone: true}" (change)="editBook(book)"></td>
            <!-- <td><button class="btn btn-warning">Update</button></td> -->
            <td><button class="btn btn-danger" (click)="deleteBook(book.book_id)">Delete</button></td>
          </ng-container>
          </tr>
        </tbody>
      </table>
</div>

</div>
